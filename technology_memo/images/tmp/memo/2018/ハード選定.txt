ハードウェア選定を検討・予測するには、考慮すべき点(業務量、ピーク時の負荷、CPU、メモリ、HDD、LAN、HBA、スペース、費用、耐用年数、運用…)は、インプット要素がたくさんある。

全ての要素を高密度の行うのは稼働がかかる、検討要素の抜け漏れは「リソース不足=サービス停止」に直結する。
↓↓↓
広範囲かつポイントを絞った見積りが必要

●1. CPU見積り
サーバ用途による分類

○1.1 オンライン系サーバ
ランダムもタイミングでのクライアントからの要求を受け、サーバ内で処理をした後、回答を返すサーバ

○1.2 バッチ系サーバ
定期的なタイミングで、インプットとなるデータを処理し、アウトプットを作成する。

○1.3 オンライン系サーバのCPU見積り
レスポンス重視、余裕あるリソース

ピーク時でも余裕を残すには、ピーク特定、伸びの予測が必須。
→ユーザヒアリング、既存システム監視(ピーク特定)組織の増員計画、業界予測(伸びの予測)

新システムのCPU性能 
≒ 旧システムCPU性能 × ピーク時CPU使用率
×伸び率 × 余裕分
× イベント時の処理件数増加率

CPU性能はSPECint_rate値で比較し算出した値に近い製品を選定する。

○1.4 バッチ系サーバのCPU見積り
運用時間内にバッチ処理を終わらせる。
必要十分のリソース

時間内にバッチ処理を終了させるには
、バッチ処理の重さを予測が必須。

バッチ処理の重さ(%時間)
≒ バッチ処理中の平均CPU使用率 × 所要時間

新システムのCPU性能
≒(バッチ処理の重さ*旧システム CPU性能)/(新システムのバッチ時間 *新システム 使用率)

CPU性能はSPECint_rate値で比較し算出した値に近い製品を選定する。


稼動傾向に合わせたCPUのサイジング事例



ーーーーーーーーーーーーーーー
●2. 物理メモリ見積り
物理メモリは最も重要なリソースです。
起動
するプロセスが使用するメモリ量を積算して必要メモリを見積もりますが、メモリの搭載量には以下に示す上限があります。

2.1 サーバマシンの最大搭載容量(メモリを何個搭載できるか)

サーバマシン(IAサーバ)の最大搭載メモリ容量(例)
+---------+---------------+--------------+--------------------+
|対象    | 1way         |2way        | 4way          |
+---------+---------------+--------------+--------------------+
|CPU数| 最大1CPU|最大2CPU| 
最大4CPU |
+---------+---------------+--------------+--------------------+
|メモリ|最大8GB   |最大32GB |最大64GB     |

〇2.2 OSの最大認識容量(必ずしも搭載しただけ使えるわけではない)
WindowsServer2003R2
Standard Edition(最大4CPU、最大4GB)
Enterprise Edition(最大8CPU、最大64GB)
DataCenter Edition(最大32CPU、最大128GB)

〇2.3 ソフトウェアが使用するメモリ量
メインの機能のソフトウェアが使用するメモリ量を見積もる事は非常に重要です。
主に以下に示す４点を把握し、見積もります。

１．どのようなプロセスが起動するか
２．プロセスの作成単位
３．プロセスの作成タイミング
４．各プロセスのメモリ使用量

各プロセスのメモリ使用量を知るには？
・実際に測定する
・メーカ推奨値を利用する
・旧バージョンの製品が手元にある場合は、その測定結果から予測する

○2.4 プロセスが親子関係を持つソフトウェアの場合のメモリ見積もり

ソフトウェアのメモリ消費量
＝ 親プロセス消費量 ＋ (子プロセス消費量 ×
ピーク時子プロセス起動数 × 伸び)

○2.5 システム全体のメモリ使用量
新システムのメモリ必要量
≒ (OS ＋ キャッシュ ＋ 運用系プロセス＋ 監視系プロセス ＋ ソフトウェア１＋ソフトウェア２ ＋ ・・・ ) × 余裕分

同時に起動するプロセスを積算していく

●3. ハードディスクの見積もり
必要な領域の使用量を加算していく
１．インストール領域(OS,ソフトウェア)
２．ログ容量(OS,ソフトウェア)
→業務量や利用者数の伸びを考慮して将来的なサイズを予測する
３．スワップ領域
４．ダンプ領域
５．作業用領域
６．一時保存領域

●3.1 システム全体のハードディスク使用量
新システムのディスク使用量
≒ (OS領域 ＋ ソフトウェアインストール領域 ＋(ログ容量 × 伸び) ＋ ワーク領域 ＋
一時保存領域) × 余裕分 ＋ スワップ領域
＋ クラッシュダンプ領域

・スワップとダンプ領域以外は余裕分を見込む
・運用終了時でもディスクの空きがあるようにする
・ぎりぎり36GBならば73GBのHDDを選択する

